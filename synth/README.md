# Прогнозирование оттока клиентов

[ipynb](https://github.com/KseniaKar/Portfolio/blob/main/telecom/telecom.ipynb)
[HTML](https://github.com/KseniaKar/Portfolio/blob/main/telecom/telecom.html)

## Описание проекта

Создание синтетического датасета, который репрезентирует закрытые данные о продаже недвижимости в Новосибирске, с добавлением геопризнаков. Синтетический датасет (необходимый размер: 9000 квартир) будет использован в рамках курса "Геопространственный анализ данных" https://ods.ai/tracks/geoanalytics-course-spring24. 


## Цель: 
Цель проекта - разработать модель машинного обучения оттока клиентов для оператора связи, используя персональные данные о клиентах, информацию об их тарифах и договорах. Модель должна помочь оператору определить, какие клиенты склонны уходить, и предложить им специальные условия и промокоды, чтобы удержать их.

## План

- Провести первичный анализ и предобработку данных
- Составить features и target для задачи машинного обучения. Объединить все четыре датафрейма и удалить неинформативные столбцы.
- Разработка модели прогнозирования оттока клиентов. Возможным методом может быть построение классификатора на основе машинного обучения, например, логистической регрессии или CatBoost, LightGBM.
- Для линейной регрессии необходимо будет закодировать категориальные признаки, и подготовить эти признаки и для других моделей.
- Подбор гиперпареметров моделей и выбор лучшей при сравнении метрики ROC-AUC (следить за accuracy).
- Тестирование модели.

## Описание услуг

Оператор предоставляет два основных типа услуг:

- Стационарную телефонную связь. Возможно подключение телефонного аппарата к нескольким линиям одновременно.
- Интернет. Подключение может быть двух типов: через телефонную линию (DSL, от англ. digital subscriber line, «цифровая абонентская линия») или оптоволоконный кабель (Fiber optic).
Также доступны такие услуги:

- Интернет-безопасность: антивирус (DeviceProtection) и блокировка небезопасных сайтов (OnlineSecurity);
- Выделенная линия технической поддержки (TechSupport);
- Облачное хранилище файлов для резервного копирования данных (OnlineBackup);
- Стриминговое телевидение (StreamingTV) и каталог фильмов (StreamingMovies).
За услуги клиенты могут платить каждый месяц или заключить договор на 1–2 года. Доступны различные способы расчёта и возможность получения электронного чека.

## Описание данных

Данные состоят из файлов, полученных из разных источников:

- contract_new.csv — информация о договоре;
- personal_new.csv — персональные данные клиента;
- internet_new.csv — информация об интернет-услугах;
- phone_new.csv — информация об услугах телефонии.



## Навыки и инструменты

- **python**
- **pandas**
- **numpy**
- **seaborn**

- sklearn.linear_model.**LogisticRegression**
- sklearn.model_selection.**GridSearchCV**
- sklearn.ensemble.**RandomForestClassifier**
- sklearn.preprocessing. **StandardScaler, OneHotEncoder**
- catboost.**CatBoostClassifier**
- **lightgbm**



## Вывод

- Проведен первичный анализ и предобработка данных. Данные проверены на наличие пропусков, дубликатов, выбросов и ошибок в данных, а также определены типы переменных и их распределение.

- Определена целевая переменная и признаки. Целевая переменная (target) будет являться бинарным признаком, указывающим, ушел клиент или остался. Features могут включать в себя информацию о демографии, тарифах, услугах, использовании связи, а также другие социально-экономические и финансовые характеристики клиента.

- Подготовлены данные для модели. Для логистической регрессии необходимо закодировать категориальные признаки, а также отмасштабировать количественные признаки.

- Проведен анализ корреляции между признаками. По результатам анализа удалены признаки, имеющие наибольшую корреляцию.

- Разработаны модели прогнозирования оттока клиентов, используя методы машинного обучения, такие как LogisticRegression или CatBoost, LightGBM, RandomForrest. Использована кросс-валидация и выбор лучшей модели на основе метрики ROC-AUC.

- Проведена оценка константной модели для проверки адекватности качества предсказаний.

- Проведен анализ важности признаков по анализу каждой модели, подбор гиперпараметров.

- Лучшая модель протестирована на отложенном наборе данных и оценена ее точность прогнозирования. Лучшей моделью оказался CatBoost: 'depth': 3, 'iterations': 200, 'learning_rate': 0.5. 7 признакков меньшей важности удалены из датасета.

- ROC AUC на тестовой выборке : 0.93, что говорит о том, что модель классификации может хорошо предсказывать, кто из клиентов склонен уйти и кто останется.

- Модель позволит оператору связи оптимизировать свою стратегию удержания клиентов и принимать более обоснованные решения по предоставлению специальных условий и промокодов тем клиентам, которые наиболее вероятно покинут оператора.

